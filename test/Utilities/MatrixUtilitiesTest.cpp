#include <Utilities/MatrixUtilities.h>
#include <Dynamics/SoftBody/SoftBodyDynamicsInterface.h>
#include <gtest/gtest.h>
#include <pch.h>

using namespace Barta::Utils;

TEST(
    MatrixUtilitiesTest,
    Create12MatrixFrom9MatrixAndThirdNewtonLaw
) {
    // clang-format off
    Matrix9Type A;
    A <<    1, 1, 1,        10, 10, 10,     100, 100, 100,
            1, 1, 1,        10, 10, 10,     100, 100, 100,
            1, 1, 1,        10, 10, 10,     100, 100, 100,

            2, 2, 2,        20, 20, 20,     200, 200, 200,
            2, 2, 2,        20, 20, 20,     200, 200, 200,
            2, 2, 2,        20, 20, 20,     200, 200, 200,

            4, 4, 4,        40, 40, 40,     400, 400, 400,
            4, 4, 4,        40, 40, 40,     400, 400, 400,
            4, 4, 4,        40, 40, 40,     400, 400, 400;

    Matrix12Type expected;
    expected <<     1, 1, 1,            10, 10, 10,         100, 100, 100,      -111, -111, -111,
                    1, 1, 1,            10, 10, 10,         100, 100, 100,      -111, -111, -111,
                    1, 1, 1,            10, 10, 10,         100, 100, 100,      -111, -111, -111,

                    2, 2, 2,            20, 20, 20,         200, 200, 200,      -222, -222, -222,
                    2, 2, 2,            20, 20, 20,         200, 200, 200,      -222, -222, -222,
                    2, 2, 2,            20, 20, 20,         200, 200, 200,      -222, -222, -222,

                    4, 4, 4,            40, 40, 40,         400, 400, 400,      -444, -444, -444,
                    4, 4, 4,            40, 40, 40,         400, 400, 400,      -444, -444, -444,
                    4, 4, 4,            40, 40, 40,         400, 400, 400,      -444, -444, -444,

                    -7, -7, -7,         -70, -70, -70,      -700, -700, -700,   777, 777, 777,
                    -7, -7, -7,         -70, -70, -70,      -700, -700, -700,   777, 777, 777,
                    -7, -7, -7,         -70, -70, -70,      -700, -700, -700,   777, 777, 777;
    // clang-format on

    auto result = create12MatrixFrom9MatrixAndThirdNewtonLaw(A);

    for (int i = 0; i < 12; ++i) {
        for (int j = 0; j < 12; ++j) {
            EXPECT_FLOAT_EQ(result(i, j), expected(i, j));
        }
    }
}
